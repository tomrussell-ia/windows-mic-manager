<Window x:Class="MicrophoneManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:tb="http://www.hardcodet.net/taskbar"
        xmlns:local="clr-namespace:MicrophoneManager"
        xmlns:views="clr-namespace:MicrophoneManager.Views"
        Title="Microphone Manager"
        Width="0" Height="0"
        WindowStyle="None"
        ShowInTaskbar="False"
        Loaded="Window_Loaded">

    <Grid>
        <!-- System Tray Icon -->
        <tb:TaskbarIcon x:Name="TrayIcon"
                        ToolTipText="{Binding TooltipText}"
                        NoLeftClickDelay="True">

            <!-- Left-click popup using built-in TrayPopup -->
            <tb:TaskbarIcon.TrayPopup>
                <views:MicrophoneFlyout/>
            </tb:TaskbarIcon.TrayPopup>

            <!-- Right-click context menu -->
            <tb:TaskbarIcon.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="{Binding StartupMenuText}" Command="{Binding ToggleStartupCommand}"/>
                    <Separator/>
                    <MenuItem Header="Exit" Command="{Binding ExitCommand}"/>
                </ContextMenu>
            </tb:TaskbarIcon.ContextMenu>
        </tb:TaskbarIcon>
    </Grid>
</Window>
